
# レイアウトの設定
複数のページを持つアプリケーションを開発する場合にヘッダーやフッターなどのコンテンツは共通でメインのコンテンツのみ異なるというケースがほとんどだと思います。
- 共通のコンテンツとメインコンテンツを分けるためにレイアウトを利用することができます。

!!! warning もしレイアウトを設定しない場合はヘッダーやフッターの更新を行った際にすべてのページで更新を行う必要がでてきます。
    そのため複数ページを持つアプリではレイアウトの設定は必須となります。

layout.tsxは、その階層以下で表示される共通のレイアウトとなります。
- それ以外のlayout.tsxは、置かれたディレクトリ以下のページの共通レイアウトとなります。

アプリケーション全体で共通のレイアウトを設定するため、Next.js 13ではapp/layout.tsx ファイル(Root Layout)を編集する
- appディレクトリ直下のlayout.tsxは特殊でRootLayoutと呼ばれ、次のように<html>や<body>タグを含む必要があります。これは従来あった_document.tsxの代替となります。

!!! warning Next.js は `<html>` や `<body>` タグを自動的に生成しないので、app/layout.tsx ファイルで必ず定義する必要があります。
## layout.tsx の中身を確認
html, body が利用されており、children の部分に page.tsx のコンテンツが挿入されます。
```typescript
import './globals.css';
import { Inter } from 'next/font/google';

const inter = Inter({ subsets: ['latin'] });

export const metadata = {
  title: 'Create Next App',
  description: 'Generated by create next app',
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode,
}) {
  return (
    <html lang="en">
      <body className={inter.className}>{children}</body>
    </html>
  );
}
```



## ヘッダーコンポーネントを追加
>https://reffect.co.jp/react/next-js-13-app/#%E3%83%98%E3%83%83%E3%83%80%E3%83%BC%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E8%BF%BD%E5%8A%A0

アプリケーション全体で共通のヘッダーコンポーネントを追加したい場合はヘッダーコンポーネントを作成して layout.tsx ファイルで import することですべてのページに適用されます。

!!! tip App Router では従来の page ディレクトリと異なり、page.tsx のような特殊なファイル名を使わない限り自由にファイルを配置できます。

app ディレクトリに header.tsx ファイルを作成して下記のコードを記述します。
```typescript
import Link from 'next/link';

const header = () => {
  return (
    <header>
      <nav className="p-2">
        <ul className="flex items-center space-x-2">
          <li>
            <img src="/vercel.svg" className="w-32" />
          </li>
          <li>
            <Link href="/">Home</Link>
          </li>
          <li>
            <Link href="/about">About</Link>
          </li>
        </ul>
      </nav>
    </header>
  );
};

export default header;
```
ロゴ画像は/public フォルダにある vercel.svg ファイルを利用します。
- img タグではなく next/image の Image コンポーネントを利用することもできます。
- ページのリンクには next/link の Link コンポーネントを利用しています。
  - Next.js 13 では Link コンポーネントの中に a タグを設定する必要はありません。
  - a タグを追加しなくてもブラウザ上では a タグが利用されます。

作成した header.tsx ファイルを app/layout.tsx ファイルで import します。
```typescript
import '../styles/globals.css';
import Header from './header';

export default function RootLayout({
  children,
}: {
  children: React.ReactNode,
}) {
  return (
    <html>
      <head />
      <body>
        <Header />
        {children}
      </body>
    </html>
  );
}
```

ヘッダーの Home または About のリンクをクリックするとスムーズにページ移動が行えることを確認してください。layout.tsx ファイルで Header コンポーネントを import しているので/(ルート), /about どちらのページにもヘッダーが表示されます。
## footerの追加
>https://reffect.co.jp/react/next-js-13-app
>https://reffect.co.jp/react/next-js/

```typescript
import React, { useState } from 'react'

export default function footer() {
  const [count, setCount] = useState(0);
  return (
    <div>
    // ボタンをクリックしてカウントを回す
    <p>{count}</p>
    <div>
      <button onClick={() => setCount(count + 1)}>Count+</button>
    </div>
    <p>Footerコンポーネント</p>
  </div>
  )
}
```
### レイアウトにfooterを追加
```typescript
import Header from './header';
import Footer from './footer';

export default function Layout({ children }) {
  return (
    <>
      <Header />
      <main>{children}</main>
      <Footer />
    </>
  );
}
```
# ページ毎に異なるレイアウト(Nested Layout)
>https://reffect.co.jp/react/next-js-13-app/#app-%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AE%E7%A2%BA%E8%AA%8D

レイアウトのネスト化を確認するために新たにルーティング/test を追加するために app ディレクトリ直下に test ディレクトリを作成してその下に page.tsx ファイルを作成します。
```typescript
const Test = () => {
  return <h1>Testページ</h1>;
};

export default Test;
```
header.tsx ファイルに/test へのリンクを設定します。
```typescript
          <li>
            <Link href="/test">Test</Link>
          </li>
```
## レイアウトでサイドバーを追加
レイアウトファイルのネスト化を行うために test ディレクトリに layout.tsx ファイルを作成します。
- レイアウトにはサイドバーを追加しています。
```typescript
export default function TestLayout({
  children,
}: {
  children: React.ReactNode,
}) {
  return (
    <div className="h-screen flex">
      <div className="bg-gray-100 p-2 w-48">サイドバー</div>
      <div className="p-2">{children}</div>
    </div>
  );
}
```
ブラウザで/test にアクセスすると test ディレクトリの layout.tsx ファイルで設定したサイドバーと app ディレクトリ直下の layout.tsx ファイルで設定したヘッダーが表示されていることが確認できます。
- このことから app 直下にある layout.tsx ファイルと app/test に作成した layout.tsx ファイルの両方が適用されていることが確認できます。

![Alt text](https://reffect.co.jp/images/react/next-js-13-app/next-js-app-8-1024x484.webp)

- app/test 以下に作成するページについてはすべて 2 つのレイアウトが適用されることになります。
- このようにディレクトリ毎にレイアウトファイルを作成してネスト化することができます。

ヘッダーのメニューから/about ページに移動するとサイドバーが表示されず app の layout.tsx ファイルのレイアウトのみ適用されていることが確認できます。

![Alt text](https://reffect.co.jp/images/react/next-js-13-app/next-js-app-9-1024x484.webp)
